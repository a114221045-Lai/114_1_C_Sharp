using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;

namespace Fuel_Economy_with_TryParse
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }

        private void calculateButton_Click(object sender, EventArgs e)
        {
            // 以下所有註解均以繁體中文撰寫，說明每一段程式碼的目的與檢查流程。

            // 宣告用來儲存使用者輸入與計算結果的變數，型別為 double
            double miles;          // 行駛英里數（使用者輸入）
            double gallons;        // 使用的汽油量（加侖，使用者輸入）
            double fuelEconomy;    // 計算出的油耗（英里 / 加侖）

            // 1) 嘗試將 milesTextBox 的文字解析為 double
            //    使用 TryParse 可避免輸入非數字時拋出例外
            if (!double.TryParse(milesTextBox.Text, out miles))
            {
                // 解析失敗：提醒使用者輸入有效的公里/英里數字（繁體中文提示）
                MessageBox.Show("請在「行駛里程（英里）」欄位輸入有效的數字。", "輸入錯誤", MessageBoxButtons.OK, MessageBoxIcon.Warning);
                milesTextBox.Focus(); // 將焦點移回該文字方塊以利使用者修正
                return; // 停止後續計算
            }

            // 2) 嘗試將 gallonsTextBox 的文字解析為 double
            if (!double.TryParse(gallonsTextBox.Text, out gallons))
            {
                // 解析失敗：提醒使用者輸入有效的加侖數字（繁體中文提示）
                MessageBox.Show("請在「使用的汽油量（加侖）」欄位輸入有效的數字。", "輸入錯誤", MessageBoxButtons.OK, MessageBoxIcon.Warning);
                gallonsTextBox.Focus();
                return; // 停止後續計算
            }

            // 3) 檢查加侖數是否為零或負值，避免除以零或不合理的結果
            if (gallons <= 0)
            {
                MessageBox.Show("使用的汽油量必須為大於零的數字。", "輸入錯誤", MessageBoxButtons.OK, MessageBoxIcon.Warning);
                gallonsTextBox.Focus();
                return;
            }

            // 4) 執行油耗計算（英里 / 加侖）並將結果格式化
            fuelEconomy = miles / gallons;

            // 5) 將計算結果顯示在介面上的 mpgLabel，並加上單位說明（繁體中文）
            //    使用 ToString("N2") 以千位分隔符與 2 位小數呈現
            mpgLabel.Text = string.Format("{0:N2} 英里/加侖", fuelEconomy);
        }

        private void exitButton_Click(object sender, EventArgs e)
        {
            // 關閉表單（釋放資源並結束應用程式視窗）
            this.Close();
        }
    }
}
